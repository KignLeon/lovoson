<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Login | Lovoson Media</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .liquid-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body
    class="bg-gradient-to-tr from-gray-100 via-gray-200 to-gray-300 min-h-screen flex items-center justify-center p-4">

    <div class="liquid-card max-w-md w-full rounded-3xl p-10 text-center relative overflow-hidden">

        <!-- Logo -->
        <div class="mb-8 flex justify-center">
            <img src="https://res.cloudinary.com/ddnhp0hzd/image/upload/v1762821610/lovoson_icon_fmdiol.svg"
                alt="Lovoson" class="h-12 w-12">
        </div>

        <h1 class="text-3xl font-bold text-black mb-2">Client Portal</h1>
        <p class="text-slate-500 mb-8">Enter your access code to manage your project.</p>

        <!-- Login Form -->
        <form id="loginForm" class="space-y-4 text-left">
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase mb-1 ml-1">Email</label>
                <input type="email" id="email" required
                    class="w-full bg-white/50 border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:border-black transition-colors"
                    placeholder="name@company.com">
            </div>

            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase mb-1 ml-1">Access Code</label>
                <input type="password" id="password" required
                    class="w-full bg-white/50 border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:border-black transition-colors"
                    placeholder="••••••••">
            </div>

            <button type="submit" id="submitBtn"
                class="w-full bg-black text-white font-bold py-3.5 rounded-xl hover:bg-slate-800 transition-all shadow-lg mt-4 flex justify-center items-center gap-2">
                <span>Enter Portal</span>
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </form>

        <p id="error-msg" class="text-red-500 text-sm mt-4 hidden font-medium flex items-center justify-center gap-2">
            <i class="fa-solid fa-circle-exclamation"></i> <span>Invalid credentials</span>
        </p>

        <div class="mt-8 pt-6 border-t border-slate-200/50">
            <a href="mailto:support@lovosonmedia.com"
                class="text-sm text-slate-400 hover:text-black transition-colors">Lost your access code?</a>
        </div>
    </div>

    <script>
        const form = document.getElementById('loginForm');
        const errorMsg = document.getElementById('error-msg');
        const submitBtn = document.getElementById('submitBtn');
        const errorText = errorMsg.querySelector('span');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // UI Reset
            errorMsg.classList.add('hidden');
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-75');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Verifying...';

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                // Send credentials to backend
                // OLD: const response = await fetch('/api/login', {
                // NEW: Point to Render backend
                const response = await fetch('https://lovoson.onrender.com/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (response.ok && data.status === 'success') {
                    // Success: Redirect to onboarding with client name
                    // In a production app, the server would set a secure cookie here.
                    // For this prototype, we pass the name to personalize the next page.
                    window.location.href = `onboarding.html?client=${encodeURIComponent(data.clientName)}`;
                } else {
                    throw new Error(data.message || 'Login failed');
                }
            } catch (err) {
                // Error Handling
                console.error("Login Error:", err);
                errorText.textContent = err.message || "Connection failed. Please try again.";
                errorMsg.classList.remove('hidden');

                // Reset Button
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-75');
                submitBtn.innerHTML = originalBtnText;

                // Clear password field
                document.getElementById('password').value = '';
            }
        });
    </script>
</body>

</html>